## P5-09a-FIX Verification: Governance Correctness

**Date:** 2026-01-15
**Status:** Completed

### 1. Recipient Validation Fixes
**File:** `app/Services/NotificationService.php`

- **Corrected Call Order:** `ClinicUserModel::isUserInClinic($clinicId, $userId)` (was reversed).
- **Corrected Patient Lookup:** Used `PatientModel::findByClinic($clinicId, $id)` instead of manual `where()->find()`.

### 2. Ledger Timestamp Fix
**File:** `app/Models/NotificationModel.php`

- **Action:** Enabled timestamps (`$useTimestamps = true`) and mapped `$createdField = 'created_at'`.
- **Result:** New ledger entries automatically have `created_at` populated, satisfying the `NOT NULL` constraint.

### 3. Guardrails Output
```text
Guardrail 'DOM sinks in app/Views' passed (0 match(es)).
Guardrail 'Group-based auth helpers' passed (0 match(es)).
Guardrail 'Raw tenant queries in controllers' passed (8 match(es)).
SaaS guardrail validation succeeded.
```