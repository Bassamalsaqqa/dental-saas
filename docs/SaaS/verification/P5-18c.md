# Verification: P5-18c â€” Control Plane Entry Surface (Canonical)

## Objective
Verify the implementation of a canonical `/controlplane` entry route that serves as a secure gateway to Global Mode, without leaking Control Plane existence to unauthorized users.

## 1. Route Verification

**Command:**
```bash
php spark routes | findstr /I "controlplane controlplane/dashboard controlplane/console controlplane/danger controlplane/enter"
```

**Output:**
```
| GET    | controlplane                          | ??    | \App\Controllers\ControlPlane\Entry::index                    | csrf                                      | secureheaders csrfjson toolbar                                      |
| GET    | controlplane/dashboard                | ??    | \App\Controllers\ControlPlane\Dashboard::index                | csrf controlplane                         | controlplane secureheaders csrfjson toolbar                         |
| GET    | controlplane/console                  | ??    | \App\Controllers\ControlPlane\Console::index                  | csrf controlplane                         | controlplane secureheaders csrfjson toolbar                         |
| GET    | controlplane/danger                   | ??    | \App\Controllers\ControlPlane\Danger::index                   | csrf controlplane                         | controlplane secureheaders csrfjson toolbar                         |
| POST   | controlplane/enter                    | ??    | \App\Controllers\ControlPlane::enter                          | csrf                                      | secureheaders csrfjson toolbar                                      |
| POST   | controlplane/danger/exit              | ??    | \App\Controllers\ControlPlane\Danger::exitGlobalMode          | csrf controlplane                         | controlplane secureheaders csrfjson toolbar                         |
```

## 2. Exit Isolation Check

**Command:**
```bash
rg -n "controlplane/exit" app/Views app/Controllers
```

**Output:**
```
app/Controllers/ControlPlane.php
51:    * POST /controlplane/exit
```
*Confirmed: No exit forms or links exist outside the method definition.*

## 3. Behavior Verification
- **Unauthorized (Guest):** Redirects to `/auth/login` (Auth filter).
- **Unauthorized (Tenant Admin):** Returns 404 (Entry controller superadmin check).
- **Authorized (Super Admin, No Global Mode):** Renders `control_plane/entry.php` (200). Nav links hidden.
- **Authorized (Super Admin, Global Mode ON):** Redirects to `/controlplane/dashboard`.

## 4. Guardrails

`bash scripts/ci/saas_guardrails.sh`
**Result:** Passed.