# Verification P4-02b: Secure Logo Upload Pipeline

## File List Touched
- `app/Controllers/Settings.php`
- `app/Views/settings/index.php`
- `docs/verification/P4-02b.md`
- `docs/SECURITY_HARDENING_PROGRAM.md`
- `docs/IMPLEMENTATION_LOG.md`
- `docs/DECISION_LOG.md`
- `docs/USER_GUIDE_BRANDING.md`

## Validation Rules
- `max_size`: 512 KB
- `is_image`: must be a valid image
- `mime_in`: image/png, image/jpg, image/jpeg, image/webp
- `ext_in`: png, jpg, jpeg, webp
- **NO SVG SUPPORT** (to prevent XSS via SVG)

## Storage Logic
- **Destination**: `public/uploads/clinic/` (via `FCPATH`)
- **Filename**: `clinic-logo.<ext>` (deterministic, using `guessExtension()`)
- **Overwrite Policy**: Deletes any existing `clinic-logo.*` before moving the new file.
- **Database Path**: Stores relative path `uploads/clinic/clinic-logo.<ext>`.

## Verification Commands & Outputs

### 1. Branding Keys Search
Command: `rg -n "clinic_logo_path|clinic_logo" app`
Output:
(to be filled)

### 2. Upload Paths Search
Command: `rg -n "uploads/clinic|clinic-logo" app/Controllers/Settings.php app/Views/settings/index.php`
Output:
(to be filled)

### 3. DOM Sink Search
Command: `rg -n "innerHTML|outerHTML|insertAdjacentHTML|\.html\(" app/Views`
Output:
(to be filled)
